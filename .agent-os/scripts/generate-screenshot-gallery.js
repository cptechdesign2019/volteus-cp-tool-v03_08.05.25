const fs = require('fs');
const path = require('path');

const screenshotsDir = path.join(__dirname, '../design/reference-screens/2025-07-22_v2-firebase');
const outputHtmlPath = path.join(screenshotsDir, 'gallery.html');

fs.readdir(screenshotsDir, (err, files) => {
    if (err) {
        console.error('Error reading directory:', err);
        return;
    }

    const imageFiles = files.filter(file => file.endsWith('.png'));

    let galleryHtml = `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volteus V2 Firebase - Reference Screenshots</title>
    <style>
        body { font-family: sans-serif; margin: 20px; background-color: #f0f2f5; color: #333; }
        .gallery { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .gallery-item { background-color: #fff; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); overflow: hidden; }
        .gallery-item img { width: 100%; height: auto; display: block; border-bottom: 1px solid #eee; }
        .gallery-item-info { padding: 15px; }
        .gallery-item-info h3 { margin-top: 0; margin-bottom: 10px; font-size: 1.1em; color: #162944; }
        .gallery-item-info p { margin: 0; font-size: 0.9em; color: #555; }
        h1 { color: #162944; margin-bottom: 30px; }
        footer { text-align: center; margin-top: 40px; font-size: 0.8em; color: #777; }
    </style>
</head>
<body>
    <h1>Volteus V2 Firebase - Reference Screenshots</h1>
    <div class="gallery">
    `;

    imageFiles.forEach(file => {
        const filenameWithoutExt = path.parse(file).name;
        // Basic attempt to extract info from filename: e.g., "login_desktop" -> "Login (Desktop)"
        const displayTitle = filenameWithoutExt.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());

        galleryHtml += `
        <div class="gallery-item">
            <a href="${file}" target="_blank">
                <img src="${file}" alt="${displayTitle}">
            </a>
            <div class="gallery-item-info">
                <h3>${displayTitle}</h3>
                <p>Filename: <code>${file}</code></p>
            </div>
        </div>
        `;
    });

    galleryHtml += `
    </div>
    <footer>
        <p>Generated by Agent OS for Volteus Project.</p>
    </footer>
</body>
</html>
    `;

    fs.writeFile(outputHtmlPath, galleryHtml, (err) => {
        if (err) {
            console.error('Error writing HTML file:', err);
        } else {
            console.log(`Gallery generated at: ${outputHtmlPath}`);
        }
    });
});